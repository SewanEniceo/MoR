<!DOCTYPE html>
<html >
<head>
	<title>Health Declaration Form</title>
	<link rel="stylesheet" type="text/css" href="style.css">
</head>
<body>
	<div class="container">
		<div class="header">
			<a href="https://tip.edu.ph">
				<img src="TIP.png" height="100px">
			</a>
			<div class="header-text">
				<h2>Technological Institute of the Philippines</h2>
				<p>938 Aurora Blvd., Cubao, Quezon City<br>https://tip.edu.ph</p>
			</div>
		</div>
		<form>
			<h1>Health Declaration Form</h1>
			<table>
				<tr>
					<td colspan="2">By signing in this form, I hereby authorize the 
						Technological Institute of the Philippines to collect and process the data indicated herein for the purpose of effecting control of the COVID-19 infection. 
						I understand that my personal information is protected by RA 10173, Data Privacy Act of 2012, and that I am required by RA 11469, 
						Bayanihan to Heal as One Act, to provide truthful information.</td>
				</tr>
				<tr>
					<td colspan="0" style="width: 100%;"><label for="enterID">Student ID:</label>
						<input type="text" id="enterID" name="enterID" size="50" required></td>
				</tr>
				<tr>
				<td colspan="1" style="width: 10%;"><label for="enterName">Name:</label>
					<input type="text" id="enterName" name="enterName" size="60" required></td>
				<td colspan="1" style="width: 0%;"><label for="enterDate">Date:</label>
					<input type="date" id="enterDate" name="enterDate" size="0" required></td>
				</tr>
				<tr>
				<td colspan="1" style="width: 10%;"><label for="enterGender">Gender:</label>
					<input type="text" id="enterGender" name="enterGender" size="20" required></td>
				<td colspan="1" style="width: 0%;"><label for="enterAge">Age:</label>
					<input type="number" id="enterAge" name="enterAge" size="0" required></td>
				</tr>
				<tr>
				<td colspan="4" style="width: 20%;"><label for="enterAddress">Complete Address: 
					<input type="text" id="enterAddress" name="enterAddress" size="100" required></label></td>
				
				</tr>
				<tr>
				<td colspan="4"><label for="enterNumber">Contact number: 
					<input type="tel" id="enterNumber" name="enterNumber" size="100"></input></label></td>
				</tr>
				<tr>
				<td colspan="2"><label for="symptoms"> 1.) Are you experiencing: (nakakaranas ka ba ng:) </label></td>
				</tr>
				<tr>
				<td colspan="2">
					<input type="checkbox" id="cough" class="symptoms" name="symptoms[]" value="cough">
					<label for="cough">Sore throat</label><br>
					<input type="checkbox" id="body" class="symptoms" name="symptoms[]" value="body pain">
					<label for="cough">Body Pains</label><br>
					<input type="checkbox" id="fever" class="symptoms" name="symptoms[]" value="fever">
					<label for="fever">Fever for the past few days ( lagnat sa mga nakalipas na araw)</label><br>
					<input type="checkbox" id="headache" class="symptoms" name="symptoms[]" value="headache">
					<label for="headache">Headache</label><br>
				</td>
				</tr>
				<tr>
				<td><label for="travel-history">2.) Have you worked together or stayed in the same close environment of a confirmed COVID-19 case? 
					(May nakasama ka bang tao na kumpirmadong may COVID-19 / Impeksyon ng coronavirus)</label></td>
				<td id="travelHistoryOptions">
					<input type="radio" id="yes" name="travel-history" value="yes">
					<label for="yes">Yes</label>
					<input type="radio" id="no" name="travel-history" value="no">
					<label for="no">No</label><br>
				</td>
				</tr>
				<tr>
					<td><label for="travel-history2">3.) Have you had any contact with anyone with cough, fever, colds, body pains, and sore throat in the past week? 
						(Mayroon ka bang nakasama na may lagnat, ubo, sipon, sakit ng katawan o sakit ng lalamunan sa nakalipas na linggo?)</label></td>
					<td id="travelHistoryOptions2">
					<input type="radio" id="yes" name="travel-history2" value="yes">
					<label for="yes">Yes</label>
					<input type="radio" id="no" name="travel-history2" value="no">
					<label for="no">No</label><br>
					</td>
				</tr>
				<tr>
					<td colspan="2"><label for="waiver"> I agree to participate in this trial test for the prototype for improvement of the current health declaration process at the Technological Institute of the Philippines regarding COVID-19.<br>

						I agree to wholeheartedly participate in this testing procedure.<br>
						
						By clicking the SUBMIT button, I hereby certify that the information provided is true and correct.</label></td>
				</tr>
				<tr>
					<td colspan="2" align="center">
						<button id="submit">Submit</button>
						<button id="remove">Remove</button> <br><br>
					</td>
				</tr>
			</table>
		  </form>
	</div>

	<div id="findDetails">
		<table>
		  <tr>
			<th colspan="2"><h1>Check by Student ID</h1></th>
		  </tr>
		  <tr>
			<td colspan="1"><h4 style="margin-bottom: 0;">Student ID</h4></td>
		  </tr>
		  <tr>
			<td><input id="findID" type="text"></td>
		  </tr>
		  <tr>
			<td colspan="1"><button id="find">FIND</button></td>
		  </tr>
		  <tr>
			<td><h3 id="findName" type="text"></h3></td>
		  </tr>
		  <tr>
			<td><h3 id="findAge" type="number"></h3></td>
		  </tr>
		  <tr>
			<td colspan="2"><h3 id="findAddress" type="text"></h3></td>
		  </tr>
		  <tr>
			<td><h3 id="findNumber" type="tel"></h3></td>
		  </tr>
		  <tr>
			<td><h3 id="findDate" type="date"></h3></td>
		  </tr>
		  <tr>
			<td colspan="2"><h3 id="findGender" type="text"></h3></td>
		  </tr>
		  <tr>
			<td colspan="2"><h3 id="findSymptoms" type="text"></h3></td>
		  </tr>
		  <tr>
			<td colspan="2"><h3 id="findTravelHistory" type="text"></h3></td>
		  </tr>
		  <tr>
			<td colspan="2"><h3 id="findTravelHistory2" type="text"></h3></td>
		  </tr>
		</table>
	  </div>

    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js";
        // TODO: Add SDKs for Firebase products that you want to use
        // https://firebase.google.com/docs/web/setup#available-libraries
      
        // Your web app's Firebase configuration
        const firebaseConfig = {
          apiKey: "AIzaSyDgkqaIQbkfF14id5OOwrtSuul5MAIcuGc",
          authDomain: "eniceo-mor.firebaseapp.com",
          databaseURL: "https://eniceo-mor-default-rtdb.asia-southeast1.firebasedatabase.app",
          projectId: "eniceo-mor",
          storageBucket: "eniceo-mor.appspot.com",
          messagingSenderId: "570200898500",
          appId: "1:570200898500:web:10b34c632f092ade5b8291"
        };
      
        // Initialize Firebase
        const app = initializeApp(firebaseConfig);

        import {getDatabase, ref, get, set, child, update, remove}
        from "https://www.gstatic.com/firebasejs/9.22.0/firebase-database.js"
        
        const db = getDatabase();

		var enterID = document.querySelector("#enterID");
        var enterName = document.querySelector("#enterName");
        var enterAge = document.querySelector("#enterAge");
		var enterAddress = document.querySelector("#enterAddress");
		var enterNumber = document.querySelector("#enterNumber");
        var enterGender = document.querySelector("#enterGender");
        var enterDate = document.querySelector("#enterDate");

		var findID = document.querySelector("#findID");
        var findName = document.querySelector("#findName");
        var findAge = document.querySelector("#findAge");
        var findGender = document.querySelector("#findGender");
        var findDate = document.querySelector("#findDate");
		var findAddress = document.querySelector("#findAddress");
		var findNumber = document.querySelector("#findNumber");
      
        var submitBtn = document.querySelector("#submit");
        var removeBtn = document.querySelector("#remove");
        var findBtn = document.querySelector("#find");

		var symptomsCheckboxes = document.querySelectorAll(".symptoms");
		var travelHistoryRadios = document.querySelectorAll('input[name="travel-history"]');
		var travelHistory2Radios = document.querySelectorAll('input[name="travel-history2"]');

		function SubmitData() {
		// ...
		
		// Get selected symptoms
		var selectedSymptoms = [];
		symptomsCheckboxes.forEach(function (checkbox) {
			if (checkbox.checked) {
			selectedSymptoms.push(checkbox.value);
			}
		});
		
		// Get selected travel history
		var selectedTravelHistory;
		travelHistoryRadios.forEach(function (radio) {
			if (radio.checked) {
			selectedTravelHistory = radio.value;
			}
		});

		// Get selected travel history 2
		var selectedTravelHistory2;
		travelHistory2Radios.forEach(function (radio) {
			if (radio.checked) {
			selectedTravelHistory2 = radio.value;
			}
		});

		set(ref(db, "People/" + enterID.value), {
			Name: enterName.value,
			ID: enterID.value,
			Age: enterAge.value,
			Gender: enterGender.value,
			Date: enterDate.value,
			Number: enterNumber.value,
			Address: enterAddress.value,
			Symptoms: selectedSymptoms,
			TravelHistory: selectedTravelHistory,
			TravelHistory2: selectedTravelHistory2
		})
			.then(() => {
			alert("Data added successfully");
			})
			.catch((error) => {
			alert(error);
			});
		}

        function FindData() {
			const dbref = ref(db);

			get(child(dbref, "People/" + findID.value))
				.then((snapshot) => {
				if (snapshot.exists()) {
					findName.innerHTML = "Name: " + snapshot.val().Name;
					findAge.innerHTML = "Age: " + snapshot.val().Age;
					findGender.innerHTML = "Gender: " + snapshot.val().Gender;
					findDate.innerHTML = "Date: " + snapshot.val().Date;
					findAddress.innerHTML = "Address: " + snapshot.val().Address;
					findNumber.innerHTML = "Number: " + snapshot.val().Number;

					// Display selected symptoms
					var selectedSymptoms = snapshot.val().Symptoms;
					var symptomsString = "Symptoms: ";
					if (selectedSymptoms && selectedSymptoms.length > 0) {
					selectedSymptoms.forEach(function (symptom) {
						symptomsString += symptom + ", ";
					});
					symptomsString = symptomsString.slice(0, -2);
					} else {
					symptomsString += "None";
					}
					findSymptoms.innerHTML = symptomsString;

					// Display selected travel history
					var selectedTravelHistory = snapshot.val().TravelHistory;
					findTravelHistory.innerHTML = "Have you worked together or stayed in the same close environment of a confirmed COVID-19 case? (May nakasama ka bang tao na kumpirmadong may COVID-19 / Impeksyon ng coronavirus): " + (selectedTravelHistory || "None");

					// Display selected travel history 2
					var selectedTravelHistory2 = snapshot.val().TravelHistory2;
					findTravelHistory2.innerHTML = "Have you had any contact with anyone with cough, fever, colds, body pains, and sore throat in the past week? (Mayroon ka bang nakasama na may lagnat, ubo, sipon, sakit ng katawan o sakit ng lalamunan sa nakalipas na linggo?): " + (selectedTravelHistory2 || "None");
				} else {
					alert("No data found");
				}
				})
				.catch((error) => {
				alert(error);
				});
			}


        function RemoveData(){
            remove(ref(db, "People/"+ enterID.value))
            .then(()=>{
                alert("Data deleted successfully");
            })
            .catch((error)=>{
                alert(error);
            });
        }

        submitBtn.addEventListener('click', SubmitData);
        removeBtn.addEventListener('click', RemoveData);
        findBtn.addEventListener('click', FindData);

    </script>

</body>
</html>
